<?xml version="1.0" encoding="utf-8"?>
<winex:WindowEx
    x:Class="OpenClawTray.Windows.WebChatWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:winex="using:WinUIEx"
    Title="OpenClaw 聊天">

    <Window.SystemBackdrop>
        <MicaBackdrop Kind="Base"/>
    </Window.SystemBackdrop>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="4" Padding="8"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">

            <Button x:Name="HomeButton" ToolTipService.ToolTip="主页" Click="OnHome"
                    Width="36" Height="36">
                <FontIcon Glyph="&#xE80F;" FontSize="14"/>
            </Button>

            <Button x:Name="RefreshButton" ToolTipService.ToolTip="刷新" Click="OnRefresh"
                    Width="36" Height="36">
                <FontIcon Glyph="&#xE72C;" FontSize="14"/>
            </Button>

            <Button x:Name="PopoutButton" ToolTipService.ToolTip="在浏览器中打开" Click="OnPopout"
                    Width="36" Height="36">
                <FontIcon Glyph="&#xE8A7;" FontSize="14"/>
            </Button>

            <Button x:Name="DevToolsButton" ToolTipService.ToolTip="开发者工具" Click="OnDevTools"
                    Width="36" Height="36">
                <FontIcon Glyph="&#xE90F;" FontSize="14"/>
            </Button>

        </StackPanel>

        <!-- WebView2 -->
        <WebView2 x:Name="WebView" Grid.Row="1"/>

        <!-- Loading indicator -->
        <ProgressRing x:Name="LoadingRing" Grid.Row="1" IsActive="True"
                      HorizontalAlignment="Center" VerticalAlignment="Center"/>

        <!-- Error display (hidden by default) -->
        <ScrollViewer x:Name="ErrorPanel" Grid.Row="1" Visibility="Collapsed" Padding="20">
            <StackPanel Spacing="12">
                <TextBlock Text="Web 聊天不可用" FontSize="18" FontWeight="SemiBold"
                           Foreground="{ThemeResource SystemFillColorCriticalBrush}"/>
                <TextBlock x:Name="ErrorText" TextWrapping="Wrap" IsTextSelectionEnabled="True"
                           FontFamily="Consolas" FontSize="12"/>
                <Button Content="在浏览器中打开" Click="OnPopout" HorizontalAlignment="Left"/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</winex:WindowEx>
